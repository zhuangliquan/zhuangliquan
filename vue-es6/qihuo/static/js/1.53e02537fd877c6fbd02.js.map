{"version":3,"sources":["webpack:///src/views/my/accountManage/changePassword.vue","webpack:///./src/views/my/accountManage/changePassword.vue?9268","webpack:///./src/views/my/accountManage/changePassword.vue"],"names":["changePassword","name","data","code","phone","showPhone","showPhoneBtn","attcode","showbtn","code_ts","sec","keying","discUrl","inputPhoneError","inputCodeError","watch","value","val","test","this","created","localStorage","getItem","abnormal","removeItem","beforeRouteEnter","to","from","next","vm","$route","params","substr","methods","inputPhone","inputCode","linkHome","$router","go","getyzcode","_this","$axios","get","then","res","object","Object","toast","duration","position","message","timer","setInterval","clearInterval","linkNewPassword","push","fromOff","accountManage_changePassword","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","title","left-arrow","on","click-left","_v","slot","_s","placeholder","error-message","input","model","callback","$$v","expression","disabled","click","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/1.53e02537fd877c6fbd02.js","sourcesContent":["<template>\n    <div class=\"changePassword\">\n      <div class=\"record-bar\">\n        <van-nav-bar\n          title=\"登录密码修改\"\n          left-arrow\n          @click-left=\"linkHome\"\n        />\n      </div>\n      <div class=\"title\" v-if=\"showPhoneBtn\">为了您的账号安全,您需要验证手机号后才能修改密码。点击获取验证码,您将收到一条附有验证码的短信</div>\n      <div class=\"title\" v-else>点击获取验证码,您将收到一条附有验证码的短信,以便修改账户密码。</div>\n      <div class=\"content\">\n        <van-cell-group>\n          <van-field v-if=\"showPhoneBtn\">\n            <div slot=\"label\" class=\"phone\">\n              <div>手机号：</div>\n              <div>{{showPhone}}</div>\n            </div>\n          </van-field>\n          <van-field v-else v-model=\"phone\" placeholder=\"请输入手机号码\" :error-message=\"inputPhoneError\" @input=\"inputPhone\">\n          </van-field>\n          <van-field v-model=\"code\" placeholder=\"请输入短信验证码\"   :error-message=\"inputCodeError\" @input=\"inputCode\">\n            <van-button slot=\"button\" class=\"code\" @click=\"getyzcode\" :disabled=\"attcode\" v-if=\"showbtn\">获取验证码</van-button>\n            <van-button slot=\"button\" class=\"code\" v-else>{{code_ts}}</van-button>\n          </van-field>\n        </van-cell-group>\n      </div>\n      <div class=\"button\" @click=\"linkNewPassword\">下一步</div>\n    </div>\n</template>\n\n<script>\n  import { Toast } from 'vant';\nexport default {\n  name: 'changePassword',\n  data () {\n    return {\n      code: '',\n      // 手机号码\n      phone:'',\n      showPhone:'',\n      // 是否来自登录界面\n      showPhoneBtn:false,\n      // 获取验证码\n      attcode: true, // 点击获取验证码按钮判断\n      showbtn: true, // 展示获取验证码或倒计时按钮判断\n      code_ts: '获取验证码', // 倒计时提示文字\n      sec: 60, // 倒计时秒数\n      // 存储验证码返回字段\n      keying: '',\n      // 盘口类型 盘口URL\n      discUrl:'',\n      inputPhoneError:'',\n      inputCodeError:'',\n    }\n  },\n  watch: {\n    phone: function (value) {\n      let reg = /\\b1[3456789]\\d{9}\\b/g\n      let val = reg.test(value)\n      if (val) {\n        this.attcode = false\n      } else {\n        this.attcode = true\n      }\n    }\n  },\n  created(){\n    console.log(this.$store.state.environment)\n    console.log(this.$store.state.discUrl)\n    this.discUrl = localStorage.getItem('discUrl')\n    // this.discUrl = '47.74.187.199'\n    if(localStorage.abnormal === 'true'){\n      localStorage.removeItem('Flag')\n    }\n  },\n  // 路由守卫\n  beforeRouteEnter (to, from, next) {\n    // console.log(to)\n    console.log(from.name)\n    next(vm => {\n      console.log(vm)\n      if (from.name === 'signIn'){\n        // console.log(vm.$route.params)\n        vm.showPhoneBtn = false\n        vm.phone = vm.$route.params.phone\n      }\n      if (from.name === 'my'){\n        vm.showPhoneBtn = true\n        vm.phone = localStorage.getItem('phone')\n        vm.showPhone = localStorage.getItem(\"phone\").substr(0,3)+\"*****\"+localStorage.getItem(\"phone\").substr(8);\n      }\n    })\n  },\n  methods: {\n    // 验证\n    inputPhone(){\n      let value = this.phone\n      let reg = /\\b1[3456789]\\d{9}\\b/g\n      let val = reg.test(value)\n      if (val) {\n        this.inputPhoneError = ''\n      } else {\n        this.inputPhoneError = '手机号格式错误，请重新填写！'\n      }\n    },\n    inputCode(){\n      let value = this.code\n      let reg = /^\\d{5}$/g\n      let val = reg.test(value)\n      // console.log(val)\n      if (val) {\n        this.inputCodeError = ''\n      } else {\n        this.inputCodeError = '验证码输入有误，请重新确认！'\n      }\n    },\n    // 返回上级\n    linkHome () {\n      this.$router.go(-1)\n    },\n    // 获取验证码倒计时\n    getyzcode () {\n      // 短信发送失败，提示手机号已注册\n      this.$axios.get('http://'+this.discUrl+':7777/api/user/sms/' + this.phone).then(res => {\n        // console.log(res)\n        if (res.data.code === 0 && res.data.object != null) {\n          Toast({\n            duration:1000,\n            position:'bottom',\n            message:'验证码发送成功'\n          })\n          this.keying = res.data.object.keying\n          let timer = setInterval(() => {\n            this.sec = this.sec - 1\n            this.code_ts = this.sec + 'S后重试'\n            this.showbtn = false\n            if (this.sec === 0) {\n              clearInterval(timer)\n              this.sec = 60\n              this.code_ts = this.sec + 'S后重试'\n              this.showbtn = true\n            }\n          }, 1000)\n        }else {\n          Toast({\n            duration:1000,\n            position:'bottom',\n            message:'验证码发送失败'\n          })\n        }\n      })\n    },\n    // 下一步设置新密码\n    linkNewPassword () {\n      if(this.phone != '' && this.code != ''){\n        if(this.showPhoneBtn){\n          this.$router.push({\n            name: 'myNewPassword',\n            params: {\n              phone:this.phone,\n              code:this.code,\n              keying:this.keying,\n              fromOff:true\n            }\n          })\n        }else {\n          console.log(this.showPhoneBtn)\n          this.$router.push({\n            name: 'newPassword',\n            params: {\n              phone:this.phone,\n              code:this.code,\n              keying:this.keying,\n              fromOff:false\n            }\n          })\n        }\n      }else {\n        Toast({\n          duration:1000,\n          message:'内容不能为空！',\n          position:'bottom'\n        })\n      }\n    },\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n  @import \"../../../style/my\";\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/my/accountManage/changePassword.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"changePassword\"},[_c('div',{staticClass:\"record-bar\"},[_c('van-nav-bar',{attrs:{\"title\":\"登录密码修改\",\"left-arrow\":\"\"},on:{\"click-left\":_vm.linkHome}})],1),_vm._v(\" \"),(_vm.showPhoneBtn)?_c('div',{staticClass:\"title\"},[_vm._v(\"为了您的账号安全,您需要验证手机号后才能修改密码。点击获取验证码,您将收到一条附有验证码的短信\")]):_c('div',{staticClass:\"title\"},[_vm._v(\"点击获取验证码,您将收到一条附有验证码的短信,以便修改账户密码。\")]),_vm._v(\" \"),_c('div',{staticClass:\"content\"},[_c('van-cell-group',[(_vm.showPhoneBtn)?_c('van-field',[_c('div',{staticClass:\"phone\",attrs:{\"slot\":\"label\"},slot:\"label\"},[_c('div',[_vm._v(\"手机号：\")]),_vm._v(\" \"),_c('div',[_vm._v(_vm._s(_vm.showPhone))])])]):_c('van-field',{attrs:{\"placeholder\":\"请输入手机号码\",\"error-message\":_vm.inputPhoneError},on:{\"input\":_vm.inputPhone},model:{value:(_vm.phone),callback:function ($$v) {_vm.phone=$$v},expression:\"phone\"}}),_vm._v(\" \"),_c('van-field',{attrs:{\"placeholder\":\"请输入短信验证码\",\"error-message\":_vm.inputCodeError},on:{\"input\":_vm.inputCode},model:{value:(_vm.code),callback:function ($$v) {_vm.code=$$v},expression:\"code\"}},[(_vm.showbtn)?_c('van-button',{staticClass:\"code\",attrs:{\"slot\":\"button\",\"disabled\":_vm.attcode},on:{\"click\":_vm.getyzcode},slot:\"button\"},[_vm._v(\"获取验证码\")]):_c('van-button',{staticClass:\"code\",attrs:{\"slot\":\"button\"},slot:\"button\"},[_vm._v(_vm._s(_vm.code_ts))])],1)],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"button\",on:{\"click\":_vm.linkNewPassword}},[_vm._v(\"下一步\")])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-aad95cea\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/my/accountManage/changePassword.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-aad95cea\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./changePassword.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./changePassword.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./changePassword.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-aad95cea\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./changePassword.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-aad95cea\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/my/accountManage/changePassword.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}