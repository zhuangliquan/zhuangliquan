webpackJsonp([29],{iV9l:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("mvHQ"),s=o.n(a),n=(o("eqfM"),o("/QYm")),r={name:"changePassword",data:function(){return{code:"",phone:"",showPhone:"",showPhoneBtn:!1,attcode:!0,showbtn:!0,code_ts:"获取验证码",sec:60,keying:"",discUrl:"",inputPhoneError:"",inputCodeError:""}},watch:{phone:function(e){var t=/\b1[3456789]\d{9}\b/g.test(e);this.attcode=!t}},created:function(){this.discUrl=localStorage.getItem("discUrl")},methods:{linkHome:function(){this.$router.go(-1)},inputPhone:function(){var e=this.phone,t=/\b1[3456789]\d{9}\b/g.test(e);this.inputPhoneError=t?"":"手机号格式错误，请重新填写！"},inputCode:function(){var e=this.code,t=/^\d{5}$/g.test(e);this.inputCodeError=t?"":"验证码输入有误，请重新确认！"},getyzcode:function(){var e=this;this.$axios.get("http://"+this.discUrl+":7777/api/user/smsregister/"+this.phone).then(function(t){if(0===t.data.code&&null!=t.data.object){Object(n.a)({duration:1e3,position:"bottom",message:"验证码发送成功"}),e.keying=t.data.object.keying;var o=setInterval(function(){e.sec=e.sec-1,e.code_ts=e.sec+"S后重试",e.showbtn=!1,0===e.sec&&(clearInterval(o),e.sec=60,e.code_ts=e.sec+"S后重试",e.showbtn=!0)},1e3)}else Object(n.a)({duration:1e3,position:"bottom",message:t.data.msg})})},linkNewPassword:function(){var e=this;e.global.ws&&1===e.global.ws.readyState&&(e.global.ws.onopen=e.onopen()),e.global.ws.onmessage=function(t){e.websocketonmessage(t)}},onopen:function(){var e;e={action:"updatePhone",reqID:88,data:{phone:this.phone,keying:this.keying,code:this.code}},this.global.ws.send(s()(e))},websocketonmessage:function(e){var t=this;this.redata=JSON.parse(e.data),"updatePhone"===this.redata.action&&(0===this.redata.data.code?n.a.success({message:"更换成功",duration:1e3,onClose:function(){t.Logout()}}):n.a.success({message:t.redata.data.msg,duration:1e3}))},linkLogout:function(){this.$store.commit("userStatus","false"),localStorage.setItem("discUrl","47.74.187.199"),localStorage.removeItem("Flag"),localStorage.removeItem("name"),localStorage.removeItem("account"),localStorage.removeItem("uid"),localStorage.removeItem("status"),localStorage.removeItem("phone"),localStorage.removeItem("disc"),localStorage.removeItem("idcard"),localStorage.removeItem("idcardtype"),localStorage.removeItem("bank"),localStorage.removeItem("bankAccount"),localStorage.removeItem("isDrawPass"),localStorage.removeItem("token"),localStorage.removeItem("upTitle"),localStorage.removeItem("positionid"),localStorage.removeItem("LoginCode"),localStorage.removeItem("LoginKeying"),localStorage.removeItem("LoginPassword"),localStorage.removeItem("LoginMode"),localStorage.removeItem("environment"),Object(n.a)({position:"bottom",message:"退出登录成功",duration:1e3}),this.$router.replace("/"),this.global.ws.close()}}},i={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"changePassword"},[o("div",{staticClass:"record-bar"},[o("van-nav-bar",{attrs:{title:"更换手机号","left-arrow":""},on:{"click-left":e.linkHome}})],1),e._v(" "),o("div",{staticClass:"title"},[e._v("请输入您想要绑定的新手机号,点击获取验证码,您将收到一条附有验证码的短信")]),e._v(" "),o("div",{staticClass:"content"},[o("van-cell-group",[e.showPhoneBtn?o("van-field",[o("div",{staticClass:"phone",attrs:{slot:"label"},slot:"label"},[o("div",[e._v("手机号：")]),e._v(" "),o("div",[e._v(e._s(e.showPhone))])])]):o("van-field",{attrs:{placeholder:"请输入手机号码","error-message":e.inputPhoneError},on:{input:e.inputPhone},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}}),e._v(" "),o("van-field",{attrs:{placeholder:"请输入短信验证码","error-message":e.inputCodeError},on:{input:e.inputCode},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}},[e.showbtn?o("van-button",{staticClass:"code",attrs:{slot:"button",disabled:e.attcode},on:{click:e.getyzcode},slot:"button"},[e._v("获取验证码")]):o("van-button",{staticClass:"code",attrs:{slot:"button"},slot:"button"},[e._v(e._s(e.code_ts))])],1)],1)],1),e._v(" "),o("div",{staticClass:"button",on:{click:e.linkNewPassword}},[e._v("绑定")])])},staticRenderFns:[]};var c=o("VU/8")(r,i,!1,function(e){o("swz1")},"data-v-f6159fec",null);t.default=c.exports},swz1:function(e,t){}});
//# sourceMappingURL=29.f6f17a75fc446f50f38e.js.map