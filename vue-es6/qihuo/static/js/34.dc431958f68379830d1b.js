webpackJsonp([34],{"4HUV":function(e,t){},EVUd:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i("eqfM");var s=i("/QYm"),o=i("mvHQ"),a=i.n(o),n=i("cWLO"),r={name:"quickClosing",data:function(){return{discUrl:"",name:"",sheetTradeShow:"",diffPriceRate:0,priceperpoint:0,NEWCPL:0,digits:0,upTitle:"11",stepperMax:3,stepper:1,add:0,stopProfit:"11",stopLoss:"1000",styleClass:"start",show:!1,instrumentid:"",uid:"",showClosePosition:!0,newClose:0,averageClose:0,bondClose:0,directionClose:0,serviceChargeClose:0,changeContentOff:!0,detailedData:[],orderList:[],tsNum:0,tickCopyData:""}},props:{appTick:{type:Array},tradeTab:{type:Number}},watch:{appTick:function(e){if(""!==JSON.parse(localStorage.tickCopy)&&(this.tickCopyData=JSON.parse(localStorage.tickCopy)),void 0!==this.tickCopyData[this.instrumentid]){var t=this.tickCopyData[this.instrumentid];this.newClose=t.price.toFixed(this.digits),this.add=(t.price-t.preclose).toFixed(this.digits),"卖"===this.directionClose?this.NEWCPL=-1*Number((Number(t.price-this.average)*this.stepper*this.priceperpoint*this.rate).toFixed(2)):this.NEWCPL=Number((Number(t.price-this.average)*this.stepper*this.priceperpoint*this.rate).toFixed(2))}}},created:function(){var e=this.$route.params;if(this.instrumentid=e.instrumentid,this.uid=e.userid,this.name=e.name,this.nameEN=e.nameEN,this.digits=e.digits,this.rate=e.rate,this.priceperpoint=e.priceperpoint,this.average=this.$route.params.average,this.directionClose=this.$route.params.directionClose,this.stepperMax=this.$route.params.MaxVolume,this.stepper=this.stepperMax,this.groupid=this.$route.params.groupid,null!==localStorage.getItem("discount")){var t=n.a.decrypt(localStorage.getItem("discount"),""),i=JSON.parse(t);if("{}"!==a()(i.data))for(var s in i.data)s===this.groupid&&(this.serviceChargeClose=this.$route.params.commissionClose*i.data[s]/100*this.stepper);else this.serviceChargeClose=this.$route.params.commissionClose*this.stepper}this.bondClose=this.$route.params.margin;var o=JSON.parse(localStorage.getItem("tickCopy")),r=o[this.instrumentid];this.newClose=r.price.toFixed(this.digits),this.add=(r.price-r.preclose).toFixed(this.digits),this.handdleMsg()},methods:{sellOut:function(){this.showSellOut=!0},closePosition:function(){this.showClosePosition=!0,this.bondClose=this.$route.params.margin},noShowSheet:function(){this.$emit("contentStyle",this.styleClass,this.show),localStorage.removeItem("positionid"),localStorage.removeItem("upTitle"),this.$router.push({name:"trade"})},handdleMsg:function(e){var t=this;t.global.ws&&1==t.global.ws.readyState&&(t.global.ws.onopen=t.onopen()),t.global.ws.onmessage=function(e){t.websocketonmessage(e)}},ConfirmClosing:function(){var e=this;this.global.ws.onopen=this.onopen3(),this.global.ws.onmessage=function(t){e.websocketonmessage3(t)}},CancelClosing:function(){this.$emit("contentStyle",this.styleClass,this.show),this.$router.push({name:"trade"})},onopen3:function(){this.setOrderList(this.stepper);var e=void 0,t=void 0,i=this,o=i.stepper,n=this.$route.params;if("买"===n.directionClose?t=0:"卖"===n.directionClose&&(t=1),this.orderList.length<=1)e={action:"placeorder",reqID:34,data:{id:null,userid:n.userid,settlementid:null,source:null,type:1,positionid:n.positionid[0],instrumentid:n.instrumentid,orderRef:"9f538075-fff6-4e84-9fee-505ce91fecf6",ordersysid:null,direction:t,volume:i.stepper,volumeTraded:null,priceType:1,limitPrice:0,distanceStopPrice:null,distanceProfitPrice:null,status:null,closed:null,frozenMargin:null,frozenMarginMember:null,tradingDay:null,createtime:null,updatetime:null,canceltime:null,hedge:null,hedgeChannel:null,distanceStop:0,distanceProfit:0}},i.global.ws.send(a()(e));else for(var r=0,l=0,d=this.orderList.length;l<d;l++)e={action:"placeorder",reqID:34,data:{id:null,userid:n.userid,settlementid:null,source:null,type:1,positionid:i.orderList[l].id,instrumentid:n.instrumentid,orderRef:"9f538075-fff6-4e84-9fee-505ce91fecf6",ordersysid:null,direction:t,volume:i.orderList[l].volume,volumeTraded:null,priceType:1,limitPrice:0,distanceStopPrice:null,distanceProfitPrice:null,status:null,closed:null,frozenMargin:null,frozenMarginMember:null,tradingDay:null,createtime:null,updatetime:null,canceltime:null,hedge:null,hedgeChannel:null,distanceStop:0,distanceProfit:0}},l<this.orderList.length-1&&(r+=this.orderList[l].volume),l===this.orderList.length-1&&(e={action:"placeorder",reqID:34,data:{id:null,userid:n.userid,settlementid:null,source:null,type:1,positionid:i.orderList[l].id,instrumentid:n.instrumentid,orderRef:"9f538075-fff6-4e84-9fee-505ce91fecf6",ordersysid:null,direction:t,volume:o-r,volumeTraded:null,priceType:1,limitPrice:0,distanceStopPrice:null,distanceProfitPrice:null,status:null,closed:null,frozenMargin:null,frozenMarginMember:null,tradingDay:null,createtime:null,updatetime:null,canceltime:null,hedge:null,hedgeChannel:null,distanceStop:0,distanceProfit:0}}),i.global.ws.send(a()(e));s.a.loading({message:i.$t("quickC"),duration:0,mask:!0,forbidClick:!0,onClose:function(){i.$router.push({name:"blank"}),Object(s.a)({message:i.$t("quickCS"),position:"bottom",duration:2e3})}})},websocketonmessage3:function(e){var t=this;this.redata=JSON.parse(e.data),"placeorder"===this.redata.action&&(0===this.redata.data.code||s.a.fail({message:t.redata.data.msg,duration:1e3,onClose:function(){t.$router.push({name:"blank"})}})),"notifitrade"!==this.redata.action&&"notifiorder"!==this.redata.action||(this.tsNum++,s.a.loading({message:t.$t("quickC"),mask:!0,duration:0,forbidClick:!0,onClose:function(){t.$router.push({name:"blank"}),Object(s.a)({message:t.$t("quickCS"),position:"bottom",duration:2e3})}}),t.tsNum>=t.orderList.length&&s.a.clear())},onopen:function(){var e;e={action:"loadposition",reqID:45,data:{userId:this.uid}},this.global.ws.send(a()(e))},websocketonmessage:function(e){if(this.redata=JSON.parse(e.data),0===this.redata.data.code&&null!=this.redata.data.object)for(var t=0,i=this.redata.data.object.length;t<i;t++)this.redata.data.object[t].instrumentid===this.$route.params.instrumentid&&(this.redata.data.object[t].volume=this.redata.data.object[t].volume-this.redata.data.object[t].volumeClosed-this.redata.data.object[t].volumeFrozen,this.detailedData.push(this.redata.data.object[t]))},setOrderList:function(e){if(""!==this.detailedData){var t=e,i=this.detailedData;this.factorial(i,t,0)}},factorial:function(e,t,i){return this.orderList.push(e[i]),e[i].volume>=t?e[i].volume:this.factorial(e,t-e[i].volume,i+1)}}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"dialog"},[i("div",{staticClass:"sellOut"},[i("van-dialog",{attrs:{closeOnPopstate:"","show-cancel-button":"","cancel-button-text":e.$t("cancel"),cancelButtonColor:"#8C8B8B",confirmButtonColor:"#1988FF","show-confirm-button":"","confirm-button-text":e.$t("ConfirmC")},on:{cancel:e.CancelClosing,confirm:e.ConfirmClosing},model:{value:e.showClosePosition,callback:function(t){e.showClosePosition=t},expression:"showClosePosition"}},[i("div",{staticClass:"dia-title",attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.$t("OrderInform")))]),e._v(" "),i("div",{staticClass:"dia-content",attrs:{slot:"default"},slot:"default"},[i("div",[i("div",[e._v(e._s(e.$t("Name"))+"：")]),e._v(" "),i("div",{staticClass:"dia-content-title"},[e._v(e._s("zh"!==e.$i18n.locale?e.nameEN:e.name))])]),e._v(" "),i("div",[i("div",[e._v(e._s(e.$t("code"))+"：")]),e._v(" "),i("div",{staticClass:"dia-content-title1"},[e._v(e._s(e.instrumentid))])]),e._v(" "),i("div",[i("div",[e._v(e._s(e.$t("direction"))+"：")]),e._v(" "),i("div",[i("span",{style:{color:"买"===e.directionClose?"#0CAD6B":"#FD4F50"}},[e._v(e._s("买"===e.directionClose?e.$t("sell"):e.$t("buy")))])])]),e._v(" "),i("div",[i("div",[e._v(e._s(e.$t("PL"))+"($)：")]),e._v(" "),i("div",{style:{color:e.NEWCPL<0?"#25B100":"#FE0000"}},[e._v(" "+e._s(e.NEWCPL))])]),e._v(" "),i("div",[i("div",[e._v(e._s(e.$t("LatestPrice"))+"：")]),e._v(" "),i("div",{style:{color:e.add<0?"#25B100":"#FE0000"}},[e._v(e._s(e.newClose))])]),e._v(" "),i("div",[i("div",[e._v(e._s(e.$t("AveragePrice"))+"：")]),e._v(" "),i("div",[e._v(e._s(e.average))])]),e._v(" "),i("div",[i("div",[e._v(e._s(e.$t("Qty"))+"：")]),e._v(" "),i("div",[e._v(e._s(e.stepper))])]),e._v(" "),i("div",[i("div",[e._v(e._s(e.$t("margin"))+"：")]),e._v(" "),i("div",[e._v(e._s(e.bondClose))])]),e._v(" "),i("div",[i("div",[e._v(e._s(e.$t("ServiceCharge"))+"：")]),e._v(" "),i("div",[e._v(e._s(e.serviceChargeClose))])])])])],1)])])},staticRenderFns:[]};var d=i("VU/8")(r,l,!1,function(e){i("4HUV")},"data-v-a243d902",null);t.default=d.exports}});
//# sourceMappingURL=34.dc431958f68379830d1b.js.map