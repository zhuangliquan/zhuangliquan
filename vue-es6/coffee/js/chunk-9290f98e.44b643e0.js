(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9290f98e"],{1276:function(t,s,e){"use strict";var a=e("d784"),i=e("44e7"),n=e("825a"),r=e("1d80"),o=e("4840"),c=e("8aa5"),l=e("50c4"),d=e("14c3"),u=e("9263"),f=e("d039"),h=[].push,p=Math.min,v=4294967295,g=!f((function(){return!RegExp(v,"y")}));a("split",2,(function(t,s,e){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,e){var a=String(r(this)),n=void 0===e?v:e>>>0;if(0===n)return[];if(void 0===t)return[a];if(!i(t))return s.call(a,t,n);var o,c,l,d=[],f=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),p=0,g=new RegExp(t.source,f+"g");while(o=u.call(g,a)){if(c=g.lastIndex,c>p&&(d.push(a.slice(p,o.index)),o.length>1&&o.index<a.length&&h.apply(d,o.slice(1)),l=o[0].length,p=c,d.length>=n))break;g.lastIndex===o.index&&g.lastIndex++}return p===a.length?!l&&g.test("")||d.push(""):d.push(a.slice(p)),d.length>n?d.slice(0,n):d}:"0".split(void 0,0).length?function(t,e){return void 0===t&&0===e?[]:s.call(this,t,e)}:s,[function(s,e){var i=r(this),n=void 0==s?void 0:s[t];return void 0!==n?n.call(s,i,e):a.call(String(i),s,e)},function(t,i){var r=e(a,t,this,i,a!==s);if(r.done)return r.value;var u=n(t),f=String(this),h=o(u,RegExp),b=u.unicode,m=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(g?"y":"g"),y=new h(g?u:"^(?:"+u.source+")",m),x=void 0===i?v:i>>>0;if(0===x)return[];if(0===f.length)return null===d(y,f)?[f]:[];var C=0,w=0,A=[];while(w<f.length){y.lastIndex=g?w:0;var k,_=d(y,g?f:f.slice(w));if(null===_||(k=p(l(y.lastIndex+(g?0:w)),f.length))===C)w=c(f,w,b);else{if(A.push(f.slice(C,w)),A.length===x)return A;for(var S=1;S<=_.length-1;S++)if(A.push(_[S]),A.length===x)return A;w=C=k}}return A.push(f.slice(C)),A}]}),!g)},3174:function(t,s,e){},6281:function(t,s,e){"use strict";e.d(s,"a",(function(){return r}));e("99af"),e("fb6a");var a=e("d4ec"),i=e("bee2"),n=function(){function t(){Object(a["a"])(this,t)}return Object(i["a"])(t,[{key:"queryString",value:function(t){var s="";for(var e in t)s+="".concat(e,"=").concat(t[e],"&");return s.slice(0,-1)}}]),t}(),r=new n},"76a1":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"pay"},[e("div",{staticClass:"top"}),e("van-nav-bar",{attrs:{title:"提交订单","left-text":"返回","left-arrow":"",fixed:!0,"z-index":"0"},on:{"click-left":t.back}}),e("div",{staticClass:"address-box"},[e("div",{staticClass:"address"},[e("div",{staticClass:"clearfix",on:{click:t.openAddressBox}},[e("div",{staticClass:"fl address-title"},[t._v("选择收货地址")]),e("div",{staticClass:"fl arrow-box"},[e("van-icon",{staticClass:"arrow-icon",attrs:{name:"arrow"}})],1)]),e("div",{staticClass:"address-content"},[e("div",{staticClass:"clearfix"},[e("div",{staticClass:"fl name"},[t._v(t._s(t.currentAddress.name))]),e("div",{staticClass:"fl phone"},[t._v(t._s(t.currentAddress.tel))])]),e("div",{staticClass:"address-info"},[t._v(t._s(t.currentAddress.address))])])])]),e("div",{staticClass:"order-info"},[e("div",{staticClass:"order-box"},[e("div",{staticClass:"order-title"},[t._v("订单信息")]),e("div",t._l(t.shopbagData,(function(s,a){return e("div",{key:a,staticClass:"clearfix cell-box"},[e("div",{staticClass:"fl pro-img"},[e("img",{staticClass:"auto-img",attrs:{src:s.small_img,alt:""}})]),e("div",{staticClass:"fl pro-info"},[e("div",{staticClass:"text-box"},[e("div",{staticClass:"clearfix"},[e("div",{staticClass:"fl text-name"},[t._v(t._s(s.name))]),e("div",{staticClass:"fl text-rule"},[t._v(t._s(s.rule))])]),e("div",{staticClass:"text-enname"},[t._v(t._s(s.enname))])]),e("div",{staticClass:"price-box"},[e("div",{staticClass:"fl price"},[t._v("￥"+t._s(s.price))]),e("div",{staticClass:"fr count"},[t._v(" "+t._s(s.count)+" ")])])])])})),0),e("div",{staticClass:"pro-box"},[e("div",{staticClass:"clearfix pro-boxing"},[e("div",{staticClass:"fl pro-count"},[t._v("共计"+t._s(t.product.count)+"件商品")]),e("div",{staticClass:"fr pro-total"},[t._v("合计 ￥"+t._s(t.product.total))])]),e("div",{staticClass:"circle-box left"}),e("div",{staticClass:"circle-box right"})])])]),e("div",{staticClass:"pay-btn"},[e("van-button",{attrs:{round:"",block:"",color:"#0C34BA"},on:{click:function(s){t.close(),t.showPupop()}}},[t._v("立即结算")]),e("van-overlay",{attrs:{show:t.showpay,"z-index":"1",duration:"0.8"}},[e("div",{staticClass:"wrapper"},[e("div",{staticClass:"box-overlay",on:{click:function(t){t.stopPropagation()}}},[e("div",{staticClass:"box-close",on:{click:t.close}},[t._v("x")]),e("h3",{staticClass:"box-title"},[t._v("请输入支付密码")]),e("div",{staticClass:"box-price"},[t._v("￥"+t._s(t.product.total))]),e("van-password-input",{attrs:{value:t.value,info:"密码为 6 位数字",focused:t.showKeyboard},on:{focus:function(s){t.showKeyboard=!0},blur:function(s){t.showKeyboard=!1}}}),e("van-button",{attrs:{color:"#0c34ba",block:""},on:{click:t.payment}},[t._v("确认支付")]),e("van-number-keyboard",{attrs:{show:t.showKeyboard},on:{input:t.onInput,delete:t.onDelete,blur:t.pay}})],1)])])],1),e("van-popup",{attrs:{position:"bottom",closeable:"","close-icon":"close",round:""},model:{value:t.isOpen,callback:function(s){t.isOpen=s},expression:"isOpen"}},[e("div",{staticClass:"popup-title"},[t._v("收货地址")]),e("van-address-list",{attrs:{list:t.list,"default-tag-text":"默认"},on:{select:t.selectAddress,add:t.newAddress,edit:t.editAddress},model:{value:t.chosenAddressId,callback:function(s){t.chosenAddressId=s},expression:"chosenAddressId"}})],1)],1)},i=[],n=(e("d81d"),e("fb6a"),e("b0c0"),e("ac1f"),e("1276"),e("3174"),e("6281")),r={data:function(){return{isOpen:!1,chosenAddressId:"",list:[],currentAddress:{name:"",tel:"",address:""},shopbagData:[],product:{count:0,total:0},sids:[],showpay:!1,value:"",showKeyboard:!1}},created:function(){this.sids=this.$route.query.sids.split("-"),this.getReceiveAddress(),this.getShopbagDataBySids()},methods:{back:function(){this.$router.go(-1)},openAddressBox:function(){this.isOpen=!0},selectAddress:function(t,s){for(var e in this.isOpen=!1,this.currentAddress)this.currentAddress[e]=t[e]},newAddress:function(){this.$router.push({name:"NewAddress"})},getReceiveAddress:function(){var t=this,s=localStorage.getItem("TK");s&&(this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"GET",url:"/findAddress",params:{appkey:this.appkey,tokenString:s}}).then((function(s){t.$toast.clear(),2e4==s.data.code&&s.data.result.map((function(s){var e=s.province+s.city+s.county+s.addressDetail;t.list.push({id:s.aid,name:s.name,tel:s.tel,address:e,isDefault:Boolean(s.isDefault)}),Boolean(s.isDefault)&&(t.chosenAddressId=s.aid,t.currentAddress.name=s.name,t.currentAddress.tel=s.tel,t.currentAddress.address=e)}))})).catch((function(s){t.$toast.clear()})))},getShopbagDataBySids:function(){var t=this,s=localStorage.getItem("TK");s&&(this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"GET",url:"/commitShopcart",params:{appkey:this.appkey,tokenString:s,sids:JSON.stringify(this.sids)}}).then((function(s){if(t.$toast.clear(),5e4==s.data.code){if(0===s.data.result.length)return t.$router.push({name:"Menu"});s.data.result.map((function(s){t.product.count+=s.count,t.product.total+=s.count*s.price})),t.product.total=t.product.total+".00",t.shopbagData=s.data.result}})).catch((function(s){t.$toast.clear()})))},showPupop:function(){var t=this;""!=this.chosenAddressId?(this.showpay=!0,setTimeout((function(){t.showKeyboard=!0}),500)):this.$toast("请选择收货地址")},pay:function(){var t=this;if(6==this.value.length){var s=localStorage.getItem("TK");if(!s)return;var e=n["a"].queryString({appkey:this.appkey,tokenString:s,sids:JSON.stringify(this.sids),phone:this.currentAddress.tel,address:this.currentAddress.address,receiver:this.currentAddress});this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0,loadingType:"spinner"}),this.axios({method:"POST",url:"/pay",data:e}).then((function(s){t.$toast.clear(),6e4==s.data.code&&(t.$toast(s.data.msg),setTimeout((function(){t.$router.push({name:"Order"})}),2e3))})).catch((function(s){t.$toast.clear()}))}},onInput:function(t){this.value=(this.value+t).slice(0,6)},onDelete:function(){this.value=this.value.slice(0,this.value.length-1)},payment:function(){6==this.value?this.showpay=!1:this.$toast("请输入六位支付密码")},close:function(){this.showpay=!1,this.showKeyboard=!1,this.value=""},editAddress:function(t){this.$router.push({name:"NewAddress",query:{aid:t.id}})}}},o=r,c=e("2877"),l=Object(c["a"])(o,a,i,!1,null,null,null);s["default"]=l.exports},"99af":function(t,s,e){"use strict";var a=e("23e7"),i=e("d039"),n=e("e8b5"),r=e("861d"),o=e("7b0b"),c=e("50c4"),l=e("8418"),d=e("65f0"),u=e("1dde"),f=e("b622"),h=e("2d00"),p=f("isConcatSpreadable"),v=9007199254740991,g="Maximum allowed index exceeded",b=h>=51||!i((function(){var t=[];return t[p]=!1,t.concat()[0]!==t})),m=u("concat"),y=function(t){if(!r(t))return!1;var s=t[p];return void 0!==s?!!s:n(t)},x=!b||!m;a({target:"Array",proto:!0,forced:x},{concat:function(t){var s,e,a,i,n,r=o(this),u=d(r,0),f=0;for(s=-1,a=arguments.length;s<a;s++)if(n=-1===s?r:arguments[s],y(n)){if(i=c(n.length),f+i>v)throw TypeError(g);for(e=0;e<i;e++,f++)e in n&&l(u,f,n[e])}else{if(f>=v)throw TypeError(g);l(u,f++,n)}return u.length=f,u}})},b0c0:function(t,s,e){var a=e("83ab"),i=e("9bf2").f,n=Function.prototype,r=n.toString,o=/^\s*function ([^ (]*)/,c="name";a&&!(c in n)&&i(n,c,{configurable:!0,get:function(){try{return r.call(this).match(o)[1]}catch(t){return""}}})},bee2:function(t,s,e){"use strict";function a(t,s){for(var e=0;e<s.length;e++){var a=s[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function i(t,s,e){return s&&a(t.prototype,s),e&&a(t,e),t}e.d(s,"a",(function(){return i}))},d4ec:function(t,s,e){"use strict";function a(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}e.d(s,"a",(function(){return a}))},d81d:function(t,s,e){"use strict";var a=e("23e7"),i=e("b727").map,n=e("1dde"),r=e("ae40"),o=n("map"),c=r("map");a({target:"Array",proto:!0,forced:!o||!c},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-9290f98e.44b643e0.js.map